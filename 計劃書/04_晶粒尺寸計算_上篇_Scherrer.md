# AXCSAS 計畫書 04：晶粒尺寸計算（上篇）- Scherrer 方法

**電鍍銅 XRD 分析系統 - 第四章**

---

## 1. Scherrer 方程式基礎

### 1.1 公式

Scherrer 方程式（1918）建立繞射峰展寬與晶粒尺寸的關係：

$$D = \frac{K\lambda}{\beta \cos\theta}$$

### 1.2 參數定義

| 符號 | 物理意義 | 單位 | 說明 |
|------|----------|------|------|
| $D$ | 晶粒尺寸 | Å 或 nm | 相干散射區沿繞射向量方向的長度 |
| $K$ | 形狀因子 | 無因次 | **電鍍銅需使用專用值** |
| $\lambda$ | X 射線波長 | Å | Cu Kα₁ = **1.54056 Å** |
| $\beta$ | 樣品展寬 | **弧度** | 必須轉換！|
| $\theta$ | Bragg 角 | 弧度 | $\theta = \frac{2\theta}{2}$ |

### 1.3 單位轉換（關鍵）

$$\beta_{rad} = \beta_{deg} \times \frac{\pi}{180}$$

> **常見錯誤**：直接使用度為單位的 FWHM 計算，導致晶粒尺寸差 57 倍！

---

## 2. 電鍍銅專用形狀因子 K

### 2.1 為什麼不能用 K = 0.89

傳統 $K = 0.89$（球形假設）**不適用於電鍍銅**：

| 問題 | 原因 |
|------|------|
| 晶粒形態錯誤 | 電鍍銅為柱狀晶或立方體，非球形 |
| hkl 相依性忽略 | 不同晶面的形狀因子不同 |
| 系統性偏差 | 低估 20-30% |

### 2.2 電鍍銅動態 K 值表（立方體假設）

根據 Langford & Wilson (1978) 推導，假設電鍍銅晶粒為立方體：

| 繞射晶面 (hkl) | 2θ (°) | **電鍍銅專用 K 值** | 通用值 (不採用) |
|----------------|--------|---------------------|-----------------|
| **(111)** | ~43.3 | **1.155** | 0.89 |
| **(200)** | ~50.4 | **1.000** | 0.89 |
| **(220)** | ~74.1 | **1.061** | 0.89 |
| (311) | ~90.0 | 1.116 | 0.89 |

### 2.3 K 值物理意義

| 晶面 | K 值 | 幾何解釋 |
|------|------|----------|
| (200) | 1.000 | 繞射向量垂直立方體面，測量邊長 |
| (220) | 1.061 | 沿面對角線方向，路徑修正 |
| (111) | 1.155 | 沿體對角線方向，修正最大 |

---

## 3. 完整計算流程

### 3.1 流程圖

```
峰擬合結果
    │
    ├── 2θ_c (峰中心)
    │       ↓
    │   θ = 2θ/2 → cos(θ)
    │
    └── FWHM_obs (觀測展寬)
            ↓
    ┌──────────────────────┐
    │ 儀器展寬校正         │
    │ β_inst = Caglioti(θ) │
    └──────────────────────┘
            ↓
    ┌──────────────────────┐
    │ 有效性檢查           │
    │ FWHM_obs > 1.2×β_inst│
    └──────────────────────┘
            ↓ YES
    ┌──────────────────────┐
    │ 樣品展寬計算         │
    │ β_sample = FWHM -    │
    │   β_inst²/FWHM       │
    └──────────────────────┘
            ↓
    ┌──────────────────────┐
    │ 單位轉換             │
    │ β_rad = β_deg × π/180│
    └──────────────────────┘
            ↓
    ┌──────────────────────┐
    │ Scherrer 計算        │
    │ D = Kλ/(β cosθ)      │
    └──────────────────────┘
            ↓
    輸出：晶粒尺寸 D (Å → nm)
```

### 3.2 有效性檢查

| 條件 | 處理 |
|------|------|
| $\beta_{obs} > 1.2 \times \beta_{inst}$ | 正常計算 |
| $\beta_{obs} \leq 1.2 \times \beta_{inst}$ | 標記 **UNRELIABLE** |

### 3.3 儀器極限警告

$$\text{if } \beta_{sample} < 0.05° \Rightarrow \text{Warning: Size > 200 nm}$$

當樣品展寬過小，已接近儀器解析極限，晶粒尺寸估計不可靠。

---

## 4. 計算案例：電鍍銅 (111) 峰

### 4.1 輸入數據

| 參數 | 數值 |
|------|------|
| 峰位置 | 2θ = 43.32° |
| 觀測 FWHM | 0.25° |
| 儀器 FWHM (from Caglioti) | 0.08° |
| 波長 | λ = 1.54056 Å |

### 4.2 計算步驟

**Step 1：有效性檢查**
$$\frac{0.25}{0.08} = 3.125 > 1.2 \quad ✓$$

**Step 2：樣品展寬**
$$\beta_{sample} = 0.25 - \frac{0.08^2}{0.25} = 0.25 - 0.0256 = 0.224°$$

**Step 3：單位轉換**
$$\beta_{rad} = 0.224 \times \frac{\pi}{180} = 0.00391 \text{ rad}$$

**Step 4：計算 cos(θ)**
$$\theta = \frac{43.32}{2} = 21.66° = 0.378 \text{ rad}$$
$$\cos\theta = \cos(21.66°) = 0.9295$$

**Step 5：Scherrer 計算（電鍍銅專用 K）**

使用 **K = 1.155**（電鍍銅 (111) 專用）：
$$D = \frac{1.155 \times 1.54056}{0.00391 \times 0.9295} = \frac{1.779}{0.00363} = 490 \text{ Å} = \mathbf{49.0 \text{ nm}}$$

對照通用值 K = 0.89：
$$D = \frac{0.89 \times 1.54056}{0.00391 \times 0.9295} = 378 \text{ Å} = 37.8 \text{ nm}$$

### 4.3 差異分析

| 假設 | K 值 | 晶粒尺寸 |
|------|------|----------|
| 電鍍銅立方體 | 1.155 | **49.0 nm** |
| 通用球形 | 0.89 | 37.8 nm |
| **差異** | - | **+30%** |

> 使用通用值會**低估**電鍍銅晶粒尺寸約 30%

---

## 5. 多峰計算與一致性檢查

### 5.1 各峰分別計算

對電鍍銅的每個峰分別計算晶粒尺寸：

| 峰 (hkl) | 2θ (°) | FWHM (°) | K | D (nm) |
|----------|--------|----------|---|--------|
| (111) | 43.32 | 0.25 | 1.155 | 49.0 |
| (200) | 50.45 | 0.28 | 1.000 | 40.2 |
| (220) | 74.16 | 0.32 | 1.061 | 45.8 |

### 5.2 各向異性判斷

| 計算結果 | 解讀 |
|----------|------|
| 各峰 D 接近（±10%）| 等軸晶傾向 |
| D 值差異大 | 各向異性生長或方向相依微觀應變 |

### 5.3 電鍍銅典型特徵

電鍍銅常見各峰 D 值不一致：
- 柱狀晶生長導致方向相依尺寸
- 需進一步使用 Williamson-Hall 分離尺寸與應變

---

## 6. 結果報告格式

### 6.1 輸出範例

```
=== Scherrer Crystallite Size Analysis ===
Sample: Cu_Electroplated_Leveler_5ppm
Analysis: Using Electroplated Cu-specific K values

| Peak   | 2θ (°)  | FWHM_obs | FWHM_sample | K     | D (nm) | Flag  |
|--------|---------|----------|-------------|-------|--------|-------|
| (111)  | 43.324  | 0.252    | 0.224       | 1.155 | 49.0   | VALID |
| (200)  | 50.451  | 0.283    | 0.251       | 1.000 | 40.2   | VALID |
| (220)  | 74.156  | 0.318    | 0.282       | 1.061 | 45.8   | VALID |
| (311)  | 89.968  | 0.345    | 0.305       | 1.116 | 48.2   | VALID |

Average D: 45.8 ± 4.0 nm
Note: Variation indicates anisotropic growth
```

---

## 7. Scherrer 方法的限制

### 7.1 適用範圍

| 條件 | 範圍 |
|------|------|
| 晶粒尺寸 | **2 - 100 nm** |
| 樣品展寬 | > 儀器展寬 × 1.2 |
| 微觀應變 | 需低或可忽略 |

### 7.2 無法分離應變

Scherrer 方程**假設所有展寬來自尺寸效應**：
- 若存在微觀應變，計算結果會偏小
- 需使用 **Williamson-Hall 方法**（下篇）分離

### 7.3 何時需要進階分析

| 情況 | 建議 |
|------|------|
| 各峰 D 差異 > 20% | 進行 W-H 分析 |
| 高添加劑濃度樣品 | 考慮應變貢獻 |
| 需要應變數據 | 必須使用 W-H |

---

## 8. 電鍍銅 Scherrer 參數標準

| 參數 | 電鍍銅專用值 |
|------|--------------|
| K (111) | **1.155** |
| K (200) | **1.000** |
| K (220) | **1.061** |
| K (311) | 1.116 |
| 波長 | 1.54056 Å |
| 有效性閾值 | 1.2 |
| 尺寸上限警告 | 200 nm |

---

*上一章：03_峰值擬合與參數提取.md*
*下一章：05_晶粒尺寸計算_下篇_WH分析.md*
